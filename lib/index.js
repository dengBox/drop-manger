!function(t,o){"object"==typeof exports&&"undefined"!=typeof module?module.exports=o():"function"==typeof define&&define.amd?define(o):(t="undefined"!=typeof globalThis?globalThis:t||self).DropManger=o()}(this,(function(){"use strict";var t=Object.prototype.toString;function o(o){return"[object Object]"===t.call(o)}function i(e){var n,s,r=(n=e,"[object Array]"!==t.call(n)?o(e)?"object":"other":"array");if("array"===r)s=[];else{if("object"!==r)return e;s={}}if("array"===r)for(var d=0;d<e.length;d++)s.push(i(e[d]));else if("object"===r)for(var a in e)s[a]=i(e[a]);return s}var e="pc"===(navigator.userAgent.match(/(iPhone|iPod|Android|ios)/i)?"mobile":"pc")?{start:"mousedown",move:"mousemove",end:"mouseup"}:{start:"touchstart",move:"touchmove",end:"touchend"};function n(t,o,i){t.addEventListener(e[o],i)}function s(t,o,i){t.removeEventListener(e[o],i)}!function(t,o){void 0===o&&(o={});var i=o.insertAt;if(t&&"undefined"!=typeof document){var e=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===i&&e.firstChild?e.insertBefore(n,e.firstChild):e.appendChild(n),n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t))}}("body{background-color:#000}#wrap{width:1000px;height:800px;margin:10px auto;-webkit-box-shadow:0 0 10px #eee;box-shadow:0 0 10px #eee;position:relative}#wrap .dropEl{width:100px;height:100px;border:1px solid red;position:absolute}#wrap .dropEl.dropEl:nth-child(2){left:110px;border-color:#0f0}#wrap .dropEl.dropEl:nth-child(3){left:220px;border-color:#00f}#wrap .boshen_active_drop{-webkit-transition:-webkit-box-shadow .3s;transition:-webkit-box-shadow .3s;transition:box-shadow .3s;transition:box-shadow .3s,-webkit-box-shadow .3s;-webkit-box-shadow:0 0 10px #0ff;box-shadow:0 0 10px #0ff}");var r={el:null,wrap:null,type:"position",useHtmlDrop:!1,activeClass:"boshen_active_drop",unit:"px",hook:{dropStart:function(){},dropMove:function(){},dropEnd:function(){}}};return function(){function e(t){this.dropState="unstart",this.config=i(r),this.activePosition={mouse:{x:0,y:0},dom:{offX:0,offY:0,width:0,height:0}},this.bindEvent={start:this.dragStart.bind(this),move:this.dragMove.bind(this),end:this.dragEnd.bind(this)},this._init(t)}var d=e.prototype;return d._init=function(t){var o,i;t.el||(o="Please pass in the moving object",void 0===i&&(i=null),console["error"](o,i||"")),this.margeConfig(this.config,t),n(this.config.el||window,"start",this.bindEvent.start)},d.destory=function(){"unstart"!==this.dropState&&s(this.config.el||window,"start",this.bindEvent.start)},d.dragStart=function(t){(n(window,"move",this.bindEvent.move),n(window,"end",this.bindEvent.end),this.dropState="start",this.activePosition.mouse={x:t.x,y:t.y},this.activePosition.dom=this.getPosition(this.config.el,this.config.wrap),this.config.el.classList.add(this.config.activeClass),"position"===this.config.type)&&(this.config.el.style.position||(this.config.el.style.position="absolute"));this.config.hook.dropStart()},d.dragMove=function(t){if("position"===this.config.type){var o=t.x-this.activePosition.mouse.x+this.activePosition.dom.offX,i=t.y-this.activePosition.mouse.y+this.activePosition.dom.offY,e=this.config.el.style;e.left=this.converUnit(o),e.top=this.converUnit(i)}this.dropState="move",this.config.hook.dropMove()},d.dragEnd=function(t){s(window,"move",this.bindEvent.move),s(window,"end",this.bindEvent.end),this.dropState="end",this.config.el.classList.remove(this.config.activeClass),this.config.hook.dropEnd()},d.getPosition=function(t,o){var i=t.getBoundingClientRect(),e=o?o.getBoundingClientRect():{x:0,y:0,width:0,height:0};return{offX:i.x-e.x,offY:i.y-e.y,width:i.width,height:i.height}},d.margeConfig=function(i,e){var n=this;(o(i)?Object.keys(i):i).forEach((function(o){var s,r;s=o,"[object Array]"===(r=t.call(s))||"[object Object]"===r?n.margeConfig(i[o],e[o]):e[o]&&(i[o]=e[o])}))},d.converUnit=function(t,o){return void 0===o&&(o=this.config.unit),t+o},e}()}));
